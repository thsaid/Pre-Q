---
title: "pre Data Cleaning"
author: "Tamer Said"
date: "27/10/2020"
output: html_document
---

This file is for cleaning my pre-q data, to clean duplicates and change the wrong names inserted in the ID



```{r}
PreQ<-read.csv("pre-quest-unique.csv", header = TRUE)

```

```{r}
library(tidyverse)
```
Selecting only the variables of interest from the dataset

```{r}
PreQ_filtered <- select(PreQ, ID, StartDate, Finished,Q1:SC0)
```

Selecting only those who have finished the survey

```{r}
PreQ_filtered <- filter(PreQ_filtered, Finished == "TRUE")
```

Retained 563 obs of 607, who have finished the survey. 


```{r}
PreQ_filtered<- filter(PreQ_filtered,Q1>1)
```

After retaining only those who have IDs more than 1, I am left with 556 obs from 563 observations.

#Renaming variables

```{r}
PreQ_filtered <- rename (PreQ_filtered, U_ID = ID,ID= Q1, Picture= Q2, Color= Q3, Gender= Q4, Day= Q5.1_1, Month= Q5.2_1, Year= Q5.3_1,Certificate=Q6, Score=SC0)

```

U_ID stands for unique ID


#Changing some ID numbers

One student entered a wrong ID number 422 instead of 4229

```{r}
PreQ_filtered$ID[PreQ_filtered$ID=="422"] <- "4229"
```

replacing 1657 with 4657

```{r}
PreQ_filtered$ID[PreQ_filtered$ID=="1657"] <- "4657"
```
 Replacing 1499 (bear strawberry) with 4799
 
```{r}
PreQ_filtered$ID[PreQ_filtered$ID=="1499"] <- "4799"
```
 
I noitced that rows 412 and 413 have the same DoB, but there was a cofnsution in the ID no. (2008 & 2018) Since he did not enter the picture or ID number,I will have to delete his entry.. or can I match it using other credentials in the post-survey?

Another student entered 3863 instead of 4863, so I will have to change this 
```{r}
PreQ_filtered$ID[PreQ_filtered$ID=="3863"] <- "4863"
```

#Another student entered 4036 instead of 4952

```{r}
PreQ_filtered$ID[PreQ_filtered$ID=="4952"] <- "4036"
```

#A wrong ID of 43337 (green bat) was entered instead of 4337

```{r}
PreQ_filtered$ID[PreQ_filtered$ID=="43337"] <- "4337"
```

#A wrong value of 9424 (gold balloon) placed instead of 4924

This code is better to use, since I can use it in another files to be consistent with the changes.. 
```{r}
PreQ_filtered$ID[PreQ_filtered$ID=="9424"] <- "4924"
```

Deleting rows for those with trial IDs (QQQQ) or empty ones.
417 and 418 have wrong numbers (2008 and 2018) will be removed, since they do not include icons as well.

```{r}

PreQ_filtered <- PreQ_filtered[-c(162,217,179,201,398,417,418), ]
```

549 observations retained


#Cleaning Duplicates

#4524
4524 shall be whale mint, another one entered the same no. with different image. The blue octopus shall be 4254 instead.

```{r}
PreQ_filtered$ID[PreQ_filtered$U_ID=="B19"] <- 4254
```


# 4264 
 2 remained. I could identify one male student: who did the class on the 18th and the girl did it on the 12th. 

I need to differentiated between the male and female by using the following:- 4264M and 4264F. If there is a duplicate, I will label the female with F, leaving the male as is. (12/4)

#4279
Female will be changed to 4279F


```{r}
PreQ$ID[PreQ$U_ID=="B236"] <- "4279F"
```
#4281

```{r}
PreQ$ID[PreQ$U_ID=="B237"] <- "4281F"
```


```{r}
PreQ_filtered$ID[PreQ_filtered$U_ID=="B35"] <- "4264F"
```

#4283

Two students one male and female, the female did the survey on 30/4. She entered a wrong certificate: national instead of IG (CES school)

```{r}
reQ_filtered$ID[PreQ_filtered$U_ID=="B160"] <- "4283F"
PreQ_filtered$Certificate[PreQ_filtered$U_ID=="B160"] <- "IGCSE (British)"
```

#4282
Two males had the same number, I could identify one of them (American Diploma), who did the session on 22/4 and 12/4. Their IDs will be followed by the school initial.

```{r}
PreQ_filtered$ID[PreQ_filtered$U_ID=="B39"] <- "4282A"

PreQ_filtered$ID[PreQ_filtered$U_ID=="B96"] <- "4282K"
```

#4291
Two duplicates on two different dates, male on 22/4, and female on 12/4.

```{r}
PreQ_filtered$ID[PreQ_filtered$U_ID=="B96"] <- "4282K"
PreQ_filtered$ID[PreQ_filtered$U_ID=="B50"] <- "4291F"
```

#4292
I found 3 duplicates of this ID number. The female will be changed to 4292F. The other 2 males did the survey on two different dates : 4/5 and 11/5.

```{r}
PreQ_filtered$ID[PreQ_filtered$U_ID=="B43"] <- "4292F"
PreQ_filtered$ID[PreQ_filtered$U_ID=="B233"] <- "4292BM"
PreQ_filtered$ID[PreQ_filtered$U_ID=="B2303"] <- "4292R"
PreQ_filtered$ID[PreQ_filtered$U_ID=="B303"] <- "4292R"

```

#4293

```{r}
write.csv(PreQ,"pre-quest-unique.csv")
```

Searching for duplicates

Loading the edited fiel



```{r}
PreQ <- read.csv(file = "pre-quest-unique.csv")
```

```{r}
duplicated(PreQ$ID)
```

It appears that I still have duplicates in the IDs, 24 values.
```{r}
duplicates <- duplicated(PreQ$ID)= TRUE
```
Will make a copy of preQ to work on it
```{r}
PreQ2 <- PreQ
```

```{r}
Duplicates <- PreQ[duplicated(PreQ$ID),] 
```
Worked, resulted in 24 observations, the remaining Note:this command only included 

#4353, changed female to F
```{r}
PreQ$ID[PreQ$U_ID=="B307"] <- "4353F"
```
#4571, The 2 females are in the same session, using IP address, I will add one digit after the 1, to the number. 45710 and 45719. The 45710 is the one who did the postquest.

```{r}
PreQ$ID[PreQ$U_ID=="B260"] <- "45710"
PreQ$ID[PreQ$U_ID=="B262"] <- "45719"
```


#4581, change female to 4581F

```{r}
PreQ$ID[PreQ$U_ID=="B337"] <- "4581F"
```
#4653
```{r}
PreQ$ID[PreQ$U_ID=="B381"] <- "4653F"
```
#4657, repeated twice, cannot differentiate between them. need to check TG records

```{r}

```

#4668,only one duplicate is repeated in the postQ, the one that is not repeated will be labelled as  "4668C"

```{r}
PreQ$ID[PreQ$U_ID=="B313"] <- "4668C"
```
#4746, B for bedaya

```{r}
PreQ$ID[PreQ$U_ID=="B422"] <- "4746B"
```

#4753

```{r}
PreQ$ID[PreQ$U_ID=="B419"] <- "4753B"
```
#4754, duplicated 3 times, one of them is the same person.One will be deleted. 

```{r}
PreQ$ID[PreQ$U_ID=="B432"] <- "4754B"
PreQ <- PreQ[-405, ]
```
changing 4755 on 18/5 to 4755B
```{r}
PreQ$ID[PreQ$U_ID=="B435"] <- "4755B"
```
changing #4756 on 18/5 to 4756B

```{r}
PreQ$ID[PreQ$U_ID=="B434"] <- "4756B"
```
#4760, same female did it twice, will delete a copy of it (the later one)
Will try to use filter function to delete based on a certain condition, beacuse deleting the rows sometimes lead to erroneous deletion

```{r}
PreQ <- PreQ %>% 
+     filter(U_ID != "B462")
```
#4763
The male will be changed to 4763B
```{r}
PreQ$ID[PreQ$U_ID=="B423"] <- "4763B"
```
The blue koala will be changed to 4764 (mistake)

```{r}
PreQ$ID[PreQ$U_ID=="B470"] <- "4764"
```
#4768

```{r}
PreQ$ID[PreQ$U_ID=="B426"] <- "4768B"
```
#4769

```{r}
PreQ$ID[PreQ$U_ID=="B431"] <- "4769B"
```

#4771

The female on 17/5 entered 4771 instead of 4711

```{r}
PreQ$ID[PreQ$U_ID=="B401"] <- "4711"
```
#4824

The pink frog will be changed to 4823 instead

```{r}
PreQ$ID[PreQ$U_ID=="B476"] <- "4823"
```

#4879

```{r}
PreQ$ID[PreQ$U_ID=="B565"] <- "4879F"
```

#4898, two females in the same session. Will use the IP address. The Ip address is not indicative

```{r}

```

Same with #4988,  

```{r}
PreQ$ID[PreQ$U_ID=="B563"] <- "4899F"
```
Saving changes in the file

```{r}
write.csv(PreQ,"pre-quest-unique.csv")
```





